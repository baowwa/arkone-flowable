# 测序流程配置系统 - 产品需求文档

**文档版本**: v2.0  
**编制日期**: 2026-02-26  
**产品名称**: ArkOne 测序流程配置系统  
**目标用户**: 生物测序实验室管理人员、技术人员

---

## 一、产品概述

### 1.1 产品定义

ArkOne 测序流程配置系统是一个支持动态工作流配置的生物测序 LIMS（实验室信息管理系统）。系统能够根据样本类型自动调整流程节点，在每个节点记录特定的实验数据字段，实现样本全生命周期的追踪和管理。

### 1.2 核心价值主张

- **灵活的流程配置**: 支持多种测序类型和样本类型的动态工作流配置
- **精准的样本追踪**: 实现样本从登记到完成的全过程追踪，准确率 > 99.9%
- **标准化的数据管理**: 确保实验数据的完整性和一致性
- **高效的流程管理**: 提升实验室流程管理效率 50%，缩短样本处理周期 30%

### 1.3 业务目标

- 提高实验室流程管理效率
- 确保样本追踪的准确性和完整性
- 支持多种测序类型和样本类型的灵活配置
- 实现数据标准化和质量控制
- 降低数据录入错误率 80%

---

## 二、用户角色

### 2.1 角色设计原则

**三层角色模型**：系统采用"核心角色 + 可选角色"的灵活设计，适应不同规模实验室的需求。

**设计背景**：
- 10-50人规模测序实验室，样本室通常只有1-2人，承担接收/登记/分装/存储/发放全部职责
- 大型实验室（50人以上）可能需要更细粒度的岗位划分
- 一个用户可同时拥有多个角色，权限取并集

### 2.2 角色概览

| 层级 | 角色名称 | 角色代码 | 主要职责 | 关键功能 |
|------|---------|---------|---------|---------|
| **核心角色** | 样本操作员 | SAMPLE_OPERATOR | 样本接收/登记/分装/存储/发放全流程操作 | 样本接收、登记、编码生成、分装、位置分配、存储、发放、库存查询 |
| **核心角色** | 实验室技术员 | LAB_TECHNICIAN | 执行流程节点、录入实验数据 | 数据填报、批量录入、质量检查 |
| **核心角色** | 质量控制员 | QC_OFFICER | 管理QC样本、判定QC结果 | QC样本管理、结果判定、异常预警 |
| **核心角色** | 科室主管 | DEPARTMENT_MANAGER | 科室任务分配、进度监控 | 任务分配、进度查询、人员管理 |
| **核心角色** | 实验室主任 | LAB_DIRECTOR | 整体管理、决策、合规监督 | 系统配置、权限管理、合规检查 |
| **核心角色** | 系统管理员 | SYSTEM_ADMIN | 系统配置、用户管理、数据维护 | 用户管理、权限配置、数据备份 |
| **可选角色** | 样本接收员 | SAMPLE_RECEIVER | 接收客户送检样本，核对信息（大型实验室可拆分） | 样本接收、信息核对、接收单打印 |
| **可选角色** | 样本登记员 | SAMPLE_REGISTRAR | 在系统中登记样本信息（大型实验室可拆分） | 样本登记、编码生成、流程预览 |
| **可选角色** | 样本分装员 | SAMPLE_DISTRIBUTOR | 对样本进行分装、转移（大型实验室可拆分） | 样本分装、位置分配、分装记录 |
| **可选角色** | 样本存储员 | SAMPLE_KEEPER | 管理样本存储位置、温度监控（大型实验室可拆分） | 样本存储、位置查询、温度监控 |
| **可选角色** | 样本发放员 | SAMPLE_ISSUER | 根据实验需求发放样本（大型实验室可拆分） | 样本发放、领取记录、库存查询 |
| **可选角色** | 仪器管理员 | INSTRUMENT_MANAGER | 仪器维护、校准、使用记录 | 仪器维护、校准管理、使用日志 |
| **可选角色** | 试剂管理员 | REAGENT_MANAGER | 试剂采购、库存管理、过期提醒 | 试剂库存、采购申请、过期管理 |
| **可选角色** | 报告审核员 | REPORT_REVIEWER | 审核实验报告、签发报告 | 报告审核、签发、归档 |

**角色启用建议**：
- **小型实验室（10-50人）**：仅启用核心角色，样本操作员承担全部样本室职责
- **中型实验室（50-100人）**：启用核心角色 + 样本接收员/登记员，实现接收与操作分离
- **大型实验室（100人以上）**：启用全部角色，实现精细化岗位管理

### 2.3 权限管理（RBAC）

**权限管理模型**: 基于角色的权限管理（Role-Based Access Control）

**核心角色权限矩阵**:

| 功能 | 样本操作员 | 科室主管 | 技术员 | 质检员 | 系统管理员 |
|------|----------|--------|-------|-------|----------|
| 样本接收 | ✅ | - | - | - | ✅ |
| 样本登记 | ✅ | - | - | - | ✅ |
| 样本分装 | ✅ | - | - | - | ✅ |
| 样本存储 | ✅ | - | - | - | ✅ |
| 样本发放 | ✅ | - | - | - | ✅ |
| 容器转移 | ✅ | - | - | - | ✅ |
| 流程预览 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 查看待处理池 | - | ✅ | - | - | ✅ |
| 创建批次任务 | - | ✅ | - | - | ✅ |
| 分配批次任务 | - | ✅ | - | - | ✅ |
| 执行批次任务 | - | - | ✅ | - | ✅ |
| 批量填报数据 | - | - | ✅ | - | ✅ |
| 查看样本 | ✅ | ✅ | ✅ | ✅ | ✅ |
| 标记异常 | - | - | - | ✅ | ✅ |
| 查看报表 | - | ✅ | - | ✅ | ✅ |
| 系统配置 | - | - | - | - | ✅ |
| 用户管理 | - | - | - | - | ✅ |
| 权限配置 | - | - | - | - | ✅ |

**权限实现方式**:
- 基于Spring Security的权限拦截
- 支持方法级别的权限控制（@PreAuthorize）
- 支持数据级别的权限控制（行级安全）
- 支持API级别的权限控制

**权限检查示例**:
```java
@PreAuthorize("hasRole('DEPARTMENT_MANAGER')")
public void createBatchTask(BatchTaskRequest request) {
    // 只有科室主管可以创建批次任务
}

@PreAuthorize("hasRole('LAB_TECHNICIAN')")
public void completeBatchTask(Long batchTaskId) {
    // 只有技术员可以完成批次任务
}
```

