<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ ·æœ¬åˆ—è¡¨ - ArkOne æµ‹åºæµç¨‹é…ç½®ç³»ç»Ÿ</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="page-header">
      <div>
        <a href="index.html" class="btn btn-text">â† è¿”å›é¦–é¡µ</a>
        <h1 class="page-title">æ ·æœ¬ç®¡ç†</h1>
      </div>
      <button class="btn btn-primary" onclick="window.location.href='sample-register.html'">
        â• æ–°å»ºæ ·æœ¬
      </button>
    </div>

    <!-- ç­›é€‰æ¡ä»¶ -->
    <div class="filter-section">
      <div class="filter-row">
        <div class="form-item">
          <label class="form-label">æ ·æœ¬ç¼–å·</label>
          <input type="text" class="form-input" id="filterSampleId" placeholder="è¯·è¾“å…¥æ ·æœ¬ç¼–å·">
        </div>

        <div class="form-item">
          <label class="form-label">æ£€éªŒé¡¹ç›®</label>
          <select class="form-select" id="filterProject">
            <option value="">å…¨éƒ¨</option>
            <option value="å…¨è´¨ç²’æµ‹åº">å…¨è´¨ç²’æµ‹åº</option>
            <option value="PCRäº§ç‰©æµ‹åº">PCRäº§ç‰©æµ‹åº</option>
          </select>
        </div>

        <div class="form-item">
          <label class="form-label">çŠ¶æ€</label>
          <select class="form-select" id="filterStatus">
            <option value="">å…¨éƒ¨</option>
            <option value="in_progress">è¿›è¡Œä¸­</option>
            <option value="completed">å·²å®Œæˆ</option>
            <option value="paused">æš‚åœ</option>
            <option value="exception">å¼‚å¸¸</option>
          </select>
        </div>

        <div class="form-item">
          <label class="form-label">æäº¤äºº</label>
          <input type="text" class="form-input" id="filterSubmitter" placeholder="è¯·è¾“å…¥æäº¤äºº">
        </div>
      </div>

      <div class="filter-row">
        <div class="form-item">
          <label class="form-label">å¼€å§‹æ—¶é—´</label>
          <input type="date" class="form-input" id="filterStartDate" value="2026-02-01">
        </div>

        <div class="form-item">
          <label class="form-label">ç»“æŸæ—¶é—´</label>
          <input type="date" class="form-input" id="filterEndDate" value="2026-02-24">
        </div>

        <div class="form-item" style="display: flex; align-items: flex-end; gap: 8px;">
          <button class="btn btn-primary" onclick="handleSearch()">ğŸ” æœç´¢</button>
          <button class="btn btn-default" onclick="handleReset()">ğŸ”„ é‡ç½®</button>
        </div>
      </div>
    </div>

    <!-- è¡¨æ ¼ -->
    <div class="table-container">
      <div class="table-toolbar">
        <div style="display: flex; gap: 8px;">
          <button class="btn btn-default" onclick="handleBatchOperation()">
            æ‰¹é‡æ“ä½œ â–¼
          </button>
          <button class="btn btn-default" onclick="handleExport()">
            ğŸ“¤ å¯¼å‡ºExcel
          </button>
        </div>
        <div class="pagination-info">
          å…± <strong>156</strong> æ¡è®°å½•
        </div>
      </div>

      <table class="table">
        <thead>
          <tr>
            <th style="width: 50px;">
              <input type="checkbox" id="selectAll" onchange="handleSelectAll()">
            </th>
            <th>æ ·æœ¬ç¼–å·</th>
            <th>æ ·æœ¬åç§°</th>
            <th>æ£€éªŒé¡¹ç›®</th>
            <th>æ ·æœ¬ç±»å‹</th>
            <th>å½“å‰èŠ‚ç‚¹</th>
            <th>çŠ¶æ€</th>
            <th>æäº¤äºº</th>
            <th>æäº¤æ—¶é—´</th>
            <th style="width: 120px;">æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="sampleTableBody">
          <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </tbody>
      </table>

      <!-- åˆ†é¡µ -->
      <div class="pagination">
        <div class="pagination-info">
          æ˜¾ç¤ºç¬¬ 1-10 æ¡ï¼Œå…± 156 æ¡
        </div>
        <div class="pagination-controls">
          <button class="pagination-btn" disabled>ä¸Šä¸€é¡µ</button>
          <button class="pagination-btn active">1</button>
          <button class="pagination-btn">2</button>
          <button class="pagination-btn">3</button>
          <button class="pagination-btn">4</button>
          <button class="pagination-btn">5</button>
          <span style="padding: 0 8px;">...</span>
          <button class="pagination-btn">16</button>
          <button class="pagination-btn">ä¸‹ä¸€é¡µ</button>
          <select class="form-select" style="width: 100px; margin-left: 16px;">
            <option value="10">10æ¡/é¡µ</option>
            <option value="20">20æ¡/é¡µ</option>
            <option value="50">50æ¡/é¡µ</option>
            <option value="100">100æ¡/é¡µ</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <script src="scripts.js"></script>
  <script>
    // ç”Ÿæˆæ›´å¤šæ¨¡æ‹Ÿæ•°æ®
    function generateMoreSamples() {
      const samples = [...mockData.samples];
      const projects = ['å…¨è´¨ç²’æµ‹åº', 'PCRäº§ç‰©æµ‹åº'];
      const statuses = ['in_progress', 'completed', 'paused', 'exception'];
      const nodes = ['æ‘‡èŒ', 'æ ¸é…¸æå–', 'æ ·æœ¬å‰å¤„ç†', 'æ–‡åº“æ„å»º', 'ä¸Šæœºæµ‹åº', 'å·²å®Œæˆ'];
      const submitters = ['å¼ ä¸‰', 'æå››', 'ç‹äº”', 'èµµå…­', 'é’±ä¸ƒ'];

      for (let i = 5; i <= 20; i++) {
        const project = projects[Math.floor(Math.random() * projects.length)];
        const status = statuses[Math.floor(Math.random() * statuses.length)];

        samples.push({
          id: `AK202602${String(24 - Math.floor(i / 10)).padStart(2, '0')}${String(i).padStart(3, '0')}`,
          name: `Sample-${String(i).padStart(2, '0')}`,
          project: project,
          type: project === 'å…¨è´¨ç²’æµ‹åº' ? 'å¹³æ¿æ ·æœ¬' : 'PCRåŸæ¶²',
          currentNode: status === 'completed' ? 'å·²å®Œæˆ' : nodes[Math.floor(Math.random() * (nodes.length - 1))],
          status: status,
          submitter: submitters[Math.floor(Math.random() * submitters.length)],
          submitTime: `2026-02-${String(24 - Math.floor(i / 10)).padStart(2, '0')} ${String(9 + Math.floor(Math.random() * 8)).padStart(2, '0')}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`
        });
      }

      return samples;
    }

    // æ¸²æŸ“è¡¨æ ¼
    function renderTable(samples) {
      const tbody = document.getElementById('sampleTableBody');
      tbody.innerHTML = '';

      samples.forEach(sample => {
        const tr = document.createElement('tr');

        // çŠ¶æ€æ ‡ç­¾
        let statusClass = '';
        let statusText = '';
        switch (sample.status) {
          case 'in_progress':
            statusClass = 'in-progress';
            statusText = 'è¿›è¡Œä¸­';
            break;
          case 'completed':
            statusClass = 'completed';
            statusText = 'å·²å®Œæˆ';
            break;
          case 'paused':
            statusClass = 'paused';
            statusText = 'æš‚åœ';
            break;
          case 'exception':
            statusClass = 'exception';
            statusText = 'å¼‚å¸¸';
            break;
        }

        tr.innerHTML = `
          <td>
            <input type="checkbox" class="sample-checkbox" value="${sample.id}">
          </td>
          <td>
            <a href="sample-detail.html?id=${sample.id}" style="color: var(--primary-color); text-decoration: none;">
              ${sample.id}
            </a>
          </td>
          <td>${sample.name}</td>
          <td>${sample.project}</td>
          <td>${sample.type}</td>
          <td>${sample.currentNode}</td>
          <td>
            <span class="status-badge ${statusClass}">${statusText}</span>
          </td>
          <td>${sample.submitter}</td>
          <td>${sample.submitTime}</td>
          <td>
            <button class="btn btn-text" onclick="viewSample('${sample.id}')">æŸ¥çœ‹</button>
            <button class="btn btn-text" onclick="editSample('${sample.id}')">ç¼–è¾‘</button>
          </td>
        `;

        tbody.appendChild(tr);
      });
    }

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      const samples = generateMoreSamples();
      renderTable(samples.slice(0, 10)); // åªæ˜¾ç¤ºå‰10æ¡
    });

    // å…¨é€‰
    function handleSelectAll() {
      const selectAll = document.getElementById('selectAll');
      const checkboxes = document.querySelectorAll('.sample-checkbox');

      checkboxes.forEach(checkbox => {
        checkbox.checked = selectAll.checked;
      });
    }

    // æœç´¢
    function handleSearch() {
      const sampleId = document.getElementById('filterSampleId').value;
      const project = document.getElementById('filterProject').value;
      const status = document.getElementById('filterStatus').value;
      const submitter = document.getElementById('filterSubmitter').value;

      console.log('æœç´¢æ¡ä»¶:', { sampleId, project, status, submitter });
      showMessage('æœç´¢åŠŸèƒ½å¼€å‘ä¸­...', 'info');

      // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨APIè¿›è¡Œç­›é€‰
      const samples = generateMoreSamples();
      let filtered = samples;

      if (sampleId) {
        filtered = filtered.filter(s => s.id.includes(sampleId));
      }
      if (project) {
        filtered = filtered.filter(s => s.project === project);
      }
      if (status) {
        filtered = filtered.filter(s => s.status === status);
      }
      if (submitter) {
        filtered = filtered.filter(s => s.submitter.includes(submitter));
      }

      renderTable(filtered.slice(0, 10));
      showMessage(`æ‰¾åˆ° ${filtered.length} æ¡è®°å½•`, 'success');
    }

    // é‡ç½®
    function handleReset() {
      document.getElementById('filterSampleId').value = '';
      document.getElementById('filterProject').value = '';
      document.getElementById('filterStatus').value = '';
      document.getElementById('filterSubmitter').value = '';
      document.getElementById('filterStartDate').value = '2026-02-01';
      document.getElementById('filterEndDate').value = '2026-02-24';

      const samples = generateMoreSamples();
      renderTable(samples.slice(0, 10));
      showMessage('ç­›é€‰æ¡ä»¶å·²é‡ç½®', 'info');
    }

    // æ‰¹é‡æ“ä½œ
    function handleBatchOperation() {
      const checked = document.querySelectorAll('.sample-checkbox:checked');

      if (checked.length === 0) {
        showMessage('è¯·å…ˆé€‰æ‹©è¦æ“ä½œçš„æ ·æœ¬', 'warning');
        return;
      }

      const ids = Array.from(checked).map(cb => cb.value);
      console.log('æ‰¹é‡æ“ä½œæ ·æœ¬:', ids);
      showMessage(`å·²é€‰æ‹© ${ids.length} ä¸ªæ ·æœ¬`, 'info');
    }

    // å¯¼å‡º
    function handleExport() {
      const samples = generateMoreSamples();
      exportToExcel(samples, 'æ ·æœ¬åˆ—è¡¨.xlsx');
    }

    // æŸ¥çœ‹æ ·æœ¬
    function viewSample(id) {
      window.location.href = `sample-detail.html?id=${id}`;
    }

    // ç¼–è¾‘æ ·æœ¬
    function editSample(id) {
      showMessage(`ç¼–è¾‘æ ·æœ¬ ${id}`, 'info');
      // å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè·³è½¬åˆ°ç¼–è¾‘é¡µé¢
    }
  </script>
</body>
</html>
