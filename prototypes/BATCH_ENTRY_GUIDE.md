# 批量数据录入功能使用指南

## 📋 功能概述

批量数据录入功能是为了解决96孔板样本逐个录入效率低下的问题而设计的。通过表格批量编辑和板位图一键填充,将96个样本的录入时间从2-3小时缩短到30分钟以内,效率提升90%+。

## 🎯 核心功能

### 1. 表格批量录入 (batch-data-entry.html)

#### 功能特点
- **96个样本同时展示**: 在一个表格中显示所有样本,一目了然
- **固定表头和首列**: 滚动时保持样本ID和列标题可见
- **键盘快速导航**:
  - Tab键: 跳到下一个单元格
  - Enter键: 跳到下一行相同字段
  - 方向键: 在单元格间移动
- **实时数据验证**: 输入时立即验证,错误单元格红色边框高亮
- **自动计算**: 输入核酸浓度后自动计算补水量
- **智能填充**: 一键填充操作人和操作时间
- **进度跟踪**: 实时显示已完成样本数量 (X/96)
- **草稿保存**: 自动保存到本地,刷新页面可恢复
- **搜索定位**: 快速搜索样本ID或孔位
- **Excel导出**: 导出所有数据到Excel

#### 使用步骤

1. **进入批量录入页面**
   - 方式1: 从导航首页点击"批量数据录入"
   - 方式2: 从单个数据录入页面点击"批量录入模式"

2. **开始录入数据**
   - 点击任意单元格开始输入
   - 使用Tab键快速切换到下一个字段
   - 使用Enter键跳到下一行相同字段

3. **使用智能填充**
   - 点击"智能填充"按钮
   - 自动为所有样本填充当前操作人和时间

4. **验证数据**
   - 输入时自动验证,错误单元格显示红色边框
   - 点击"验证全部"按钮检查所有数据
   - 查看进度条了解完成情况

5. **保存和提交**
   - 点击"保存草稿"暂存数据
   - 点击"批量提交"一次性提交所有数据
   - 提交前会检查必填字段和数据有效性

#### 快捷操作

| 操作 | 快捷键/方式 |
|------|-----------|
| 跳到下一个单元格 | Tab |
| 跳到下一行 | Enter |
| 复制行数据 | 点击行操作的"复制"按钮 |
| 清空行数据 | 点击行操作的"清空"按钮 |
| 搜索样本 | 在搜索框输入样本ID或孔位 |
| 智能填充 | 点击"智能填充"按钮 |
| 验证全部 | 点击"验证全部"按钮 |
| 保存草稿 | 点击"保存草稿"或自动保存 |
| 导出Excel | 点击"导出Excel"按钮 |
| 批量提交 | 点击"批量提交"按钮 |

#### 数据验证规则

| 字段 | 验证规则 | 错误提示 |
|------|---------|---------|
| 核酸浓度 | 0-1000 ng/μL | 浓度范围: 0-1000 |
| OD260/280 | 1.6-2.2 | 范围: 1.6-2.2 |
| OD260/230 | 1.8-2.5 | 范围: 1.8-2.5 |
| 操作人 | 必填 | 请选择操作人 |
| 操作时间 | 必填 | 请选择操作时间 |

#### 状态标识

- **白色背景**: 未完成录入
- **蓝色背景**: 已完成录入(必填字段已填写且无错误)
- **红色背景**: 存在验证错误
- **绿色边框**: 数据验证通过
- **红色边框**: 数据验证失败

### 2. 板位图一键填充 (plate-map.html)

#### 功能特点
- **可视化板位图**: Canvas渲染96孔板布局
- **一键填充**: 输入板号后自动为所有孔位填充
- **动画效果**: 绿色波纹扩散显示填充进度
- **实时统计**: 显示已使用和空闲孔位数量

#### 使用步骤

1. **打开板位图页面**
   - 从导航首页点击"板位图可视化"

2. **选择容器**
   - 在顶部下拉框选择容器(如: P096-001)

3. **进入数据录入模式**
   - 在右侧信息面板找到"数据录入模式"区域
   - 输入96孔板号(如: P096-001)

4. **一键填充**
   - 点击"一键填充所有孔位"按钮
   - 确认操作
   - 观看绿色波纹动画效果
   - 等待填充完成提示

5. **查看结果**
   - 所有孔位变为蓝色(已使用状态)
   - 统计信息更新为"已使用: 96, 空闲: 0"
   - 点击任意孔位查看详细信息

#### 动画效果说明

填充过程中会看到:
- 从左上角(A01)开始,逐个孔位填充
- 每个孔位显示绿色波纹扩散动画
- 孔位颜色从灰色变为蓝色
- 整个过程约3秒完成

## 💡 最佳实践

### 批量录入建议

1. **分批录入**
   - 如果样本数量很多,建议分批录入
   - 每批录入完成后点击"保存草稿"
   - 避免一次性录入过多导致疲劳

2. **先填充公共字段**
   - 使用"智能填充"先填充操作人和时间
   - 再逐个填写样本特定数据

3. **利用键盘导航**
   - 熟练使用Tab和Enter键
   - 减少鼠标操作,提高效率

4. **及时验证**
   - 录入一批后点击"验证全部"
   - 及时发现和修正错误

5. **定期保存草稿**
   - 虽然有自动保存,但建议手动保存
   - 避免意外情况导致数据丢失

### 板位图填充建议

1. **确认板号正确**
   - 填充前仔细核对板号
   - 填充后无法撤销

2. **按流程节点填充**
   - 在对应的流程节点使用一键填充
   - 避免重复填充

3. **检查填充结果**
   - 填充完成后点击孔位查看信息
   - 确认数据正确

## 🚀 效率对比

### 传统逐个录入
- 96个样本 × 每个2分钟 = 192分钟(3.2小时)
- 需要频繁切换页面
- 容易出错,需要反复检查
- 操作繁琐,容易疲劳

### 批量录入模式
- 96个样本 × 每个20秒 = 32分钟(0.5小时)
- 在一个页面完成所有操作
- 实时验证,减少错误
- 键盘导航,操作流畅
- **效率提升: 90%+**

### 一键填充
- 输入板号 + 点击按钮 = 10秒
- 自动填充96个孔位
- 无需手动输入
- **效率提升: 99%+**

## ⚠️ 注意事项

### 批量录入

1. **浏览器兼容性**
   - 建议使用Chrome、Firefox或Edge最新版本
   - Safari可能存在兼容性问题

2. **数据保存**
   - 草稿保存在浏览器本地存储
   - 清除浏览器缓存会丢失草稿
   - 重要数据请及时提交

3. **网络连接**
   - 提交时需要网络连接
   - 网络中断可能导致提交失败
   - 建议在网络稳定时提交

4. **数据验证**
   - 提交前务必验证所有数据
   - 错误数据会导致提交失败
   - 必填字段必须填写

### 板位图填充

1. **不可撤销**
   - 一键填充后无法撤销
   - 填充前请仔细确认

2. **覆盖数据**
   - 填充会覆盖现有数据
   - 如有重要数据请先备份

3. **板号唯一性**
   - 确保板号在系统中唯一
   - 避免重复使用板号

## 🔧 故障排除

### 常见问题

**Q: 草稿无法恢复?**
A: 检查浏览器是否清除了缓存,或者使用了隐私模式。建议使用普通模式并定期手动保存。

**Q: 键盘导航不工作?**
A: 确保焦点在输入框内,某些浏览器扩展可能会干扰键盘事件。

**Q: 验证总是失败?**
A: 检查数据格式是否正确,数值是否在有效范围内,必填字段是否已填写。

**Q: 提交后没有反应?**
A: 检查网络连接,查看浏览器控制台是否有错误信息。

**Q: 一键填充没有动画?**
A: 可能是浏览器性能问题,刷新页面重试。动画不影响填充功能。

**Q: 导出Excel失败?**
A: 检查浏览器是否允许下载,某些浏览器可能会阻止自动下载。

## 📞 技术支持

如遇到问题或有改进建议,请联系开发团队。

---

**文档版本**: v1.0
**更新日期**: 2026-02-25
**适用版本**: 原型 v1.1+
